dist: trusty
language: java
# We now cache the Maven dependencies directory for faster builds
cache:
  apt: true
  directories:
  - $HOME/.m2
  - $HOME/.downloads
sudo: false

addons:
  apt:
    sources:
      - sourceline: 'deb http://repos.azulsystems.com/ubuntu stable main'
        keyurl: 'http://repos.azulsystems.com/RPM-GPG-KEY-azulsystems'
    packages:
      - oracle-java8-installer
      - oracle-java8-unlimited-jce-policy
      - zulu-8
      - wget
      - unzip

before_script:
  - mkdir -p $HOME/.downloads
  - wget -nc -q -O $HOME/.downloads/ZuluJCEPolicies.zip 'https://cdn.azul.com/zcek/bin/ZuluJCEPolicies.zip'
  - echo "8021a28b8cac41b44f1421fd210a0a0822fcaf88d62d2e70a35b2ff628a8675a  $HOME/.downloads/ZuluJCEPolicies.zip" | sha256sum -c
  - unzip -o $HOME/.downloads/ZuluJCEPolicies.zip -d $JAVA_HOME/lib/security

before_install:
  - echo 'MAVEN_OPTS="-Dorg.slf4j.simpleLogger.defaultLogLevel=warn"' >~/.mavenrc

matrix:
  fast_finish: true
  include:
    # checkstyle
    - jdk: oraclejdk8
      env:
        - DESC="checkstyle"
        - CMD="mvn clean checkstyle:check"
        - LANG=en_US.utf8
    # unit tests (oraclejdk8)
    - jdk: oraclejdk8
      env:
        - DESC="oraclejdk8 unit tests"
        - CMD="mvn clean test -Dcheckstyle.skip=true"
        - LANG=en_US.utf8
    # unit tests (openjdk8)
    - jdk: openjdk8
      env:
        - DESC="openjdk8 unit tests"
        - CMD="mvn clean test -Dcheckstyle.skip=true"
        - LANG=en_US.utf8
    - env:
        - JAVA_HOME=/usr/lib/jvm/zulu-8-amd64
        - DESC="zulu-8 unit tests"
        - CMD="mvn clean test -Dcheckstyle.skip=true"
        - LANG=en_US.utf8

script: echo ${CMD}; ${CMD}
